# 文件操作

+ 文件``QFile``

+ 文件流``QTextStream``

+ 目录``QDir``

+ 文件信息`QFileInfo`

	

## 文件

Qt提供了QFile类用于进行文件操作。QFile类提供了读写文件的接口，可以读写文本文件，二进制文件和Qt资源文件

处理文本文件和二进制文件，可以使用``QTextStream``类和``QDataStream``类。

处理临时文件可以使用``QTemporaryFile``,获取文件信息可以使用``QFileInfo``，处理目录可以使用``QDir``，监视文件和目录变化使用``QFileSystemWatcher``.

```cpp
QFile file("1.txt");
 //1.判断文件是否存在
if(!file.exists()){
    qDebug()<<"文件不存在";
}
//2.删除文件
file.remove();
//3.重命名
file.rename("1.txt");
//4.拷贝文件
QFile::copy("1.txt","2.txt");
```

打开方式

```cpp
if(!file.open(QIODevice::ReadWrite|QIODevice::Text)){
    qDebug()<<"文件打开失败";
    return 0;
}
```



### 读写文本文件

读写文本文件的方式有两种,一是直接利用传统的QFile类的方法, 另一种是利用更为方便的QTextStream类的方法.

## 文件流

QFile类读写文本,QFile类提供了读写文件的接口,QTextStream类读写文本,

QTextStream提供了更为方便的接口来读写文本，它可以操作QIODevice、QByteArray和QString。使用QTextStream的流操作符，可以方便地读写单词、行和数字。为了产生文本，QTextStream还提供了填充、对齐和数字格式化的选项。

```cpp
//QTextStrem文本文件流
QTextStream str(&file);

QString st="hello";
QString ss="world";
//1.写文件
str<<st<<" "<<ss;
```

打开文件使用open()函数，关闭文件使用close()函数。

此外的open()函数打开文件方式有三种。

| 打开方式               | 描述 |
| ---------------------- | ---- |
| `QIODevice::ReadOnly`  | 只读 |
| `QIODevice::WriteOnly` | 只写 |
| `QIODevice::ReadWrite` | 读写 |

## 目录 `QDIR`

QDir类具有存取目录结构和内容的能，使用它可以操作目录、存取目录或文件信息、操作底层文件系统，而且还可以存取Qt的资源文件

Qt使用”/”作为通用的目录分隔符和URL路径分隔符。如果在程序中使用”/”,作为目录分隔符，Qt会将其自动转换为符合底层操作系统的分隔符(如Linux使用”/”，windows使用”\”).

QDir可以使用相对路径或绝对路径指定一个文件。

isRelative()和isAbsolute()函数可以判断QDir对象使用的是相对路径还是绝对路劲。如果需要将一个相对路径转换为绝对路径，则使用makeAbsolute()函数。

目录的路径可以通过path()函数返回，通过setPath()函数设置新路径。绝对路径使用absolutePath()返回，目录名可以使用dirName()获得，它通常返回路径中的最后一个元素，如果QDir指向当前目录，则返回”.”。

目录的路径可以通过cd()和cdUp(),isRelative()和isRoot()来获取。

目录下游很多条目，包括文件、目录和符号连接，总的条目数可以使用count()来统计。
entryList()返回目录下所有条目组成的字符串链表。

可以使用remove()函数删除文件。

用rmdir()删除目录

```cpp

```



## 文件信息

使用QFileInfo类获取文件信息

QFileInfo类为我们提供了系统无关的文件信息，包括文件的名字和在文件系统中位置，文件的访问权限，是否是目录或符合链接，等等。

并且，通过这个类，可以修改文件的大小和最后修改、读取时间
。同时，QFileInfo类也可以用来取到Qt 资源的相关信息。

QFileInfo既可以表示绝对路径，也可以表示相对路径的文件。

其中，绝对路径就是已"/"开始的路径（或者在Windows系统上就是已某个盘符开始的路径）。

相对路径就是相对于当前目录的一个文件或目录。

我们在开发中，可以使用给类的成员函数isRelative() 来判断一个QFileInfo表示的是一个相对路径还是一个绝对路径。

也可以使用makeAbsolute()将一个相对路径转换为一个绝对路径。

可以使用exists() 函数判断一个文件是否存在

使用size（）函数获取文件的大小

isFile()、isDir()、isSymLink() 可以判断文件的类型，普通文件、目录或是符号链接。 

若QFileInfo 当前代表的是一个符号链接，sysLinkTarget() 函数返回符号链接所指向的文件。





# 总结

