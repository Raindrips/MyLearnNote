# 用户事件

事件的重要三个概念

+ 事件
+ 事件源
+ 事件处理着



## 事件

事件类`Event`,子类主要有

1. `EventTouch`(触摸事件)
2. `EventMouse`(鼠标事件)
3. `EventKeyBoard`(键盘事件)
4. `EventAcceleration`(加速度事件)

## 事件源

事件源是Cocos2d-x中的精灵层,菜单等节点对象\

### 事件处理着

`EventListener`中的事件处理着是事件监听类,主要功能有

+ EventListenerTouchOneByOne(单点触摸事件)
+ EventListenerTouchAllAtOnce(多点触摸事件监听器)
+ EventListenerMouse(鼠标事件监听器)
+ EventListenerAcceleration(加速度监听事件)
+ EventListenerCustom(自定义监听事件)

## 事件分发器

监听器与事件有对应关系

`EventDispatcher` 类采用单例模式的方式实现,注册事件监听器到事件分发器函数如下

```cpp
//通过单例模式获取事件分发器对象
Director::getInstance()->getEventDispatcher();

class  EventDispatcher{
    //注册事件监听器,值越小优先级越小
    void addEventListenerWithFixedPriority(EventListener *listener,int fixedPriority);

    //注销指定的事件监听器
    void removeEventListener(EventListener *listener);

    //注销自定义事件监听器
    void removeCustomEventListener(EventListener *listener);

    //注销自定义事件
    void removeAllEventListeners();

    //注销所有事件
    void removeAllEventListeners();
}
```



### 触摸事件

触摸事件有一下方法

+ 按下
+ 移动
+ 抬起

单点触摸事件

`EventListenerTouchOnceByOnce` 事件

```c++
//触摸时调用
class EventListenerTouchOnceByOnce 
{
    std::function<bool(Touch* Event*)> onTouchMoved;

    //手指离开时调用
    std::function<bool(Touch* Event*)> onTouchEnded;

    //单点触摸被取消时调用
    std::function<bool(Touch* Event*)> onTouchCancelled;
};
```

触摸事件移动操作

EventListenerTouchAllAtOnce 中触摸响应属性

```c++
//多点鼠标触摸事件
class EventListenerTouchAllAtOnce {
    //多点触摸响应事件
    std::function<bool(Touch* Event*)> onTouchesBegan;

    //多手指移动事件    
    std::function<bool(Touch* Event*)> onTouchesMoved;

    //多手指离开事件
    std::function<bool(Touch* Event*)> onTouchesEnded;

    //多手指事件取消
    std::function<bool(Touch* Event*)> onTouchesCancelled;
};
```

## 添加事件

使用`CC_CALLBACK_2`进行事件绑定

````cpp
//添加事件管理对象
auto dispatcher = Director::getInstance()->getEventDispatcher();

//创建事件
auto listener = EventListenerxxxx::create();

//绑定事件回调
listener->addxxxx=CC_CALLBACK_2(类名::回调函数,this);

//事件
Director::getInstance()->getEventDispatcher(); 

//系统实现好的系统分发器对象
_eventDispatcher
````



