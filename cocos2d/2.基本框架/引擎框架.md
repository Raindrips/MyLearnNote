# 引擎基础

+ 游戏的原理和机制
+ 游戏开发技术
+ 认识cocos2d-x引擎
+ cocos2d-x跨平台开发环境搭建

## 学习目标

- 了解游戏生命周期

- 了解程序开发,编译,运行,调试

+ cocos2d-x引擎框架
+ cocos2d-x坐标系统
+ cocos2d-x内存管理
+ UI系统
+ 事件处理



## 场景与层

 **场景(Scene)** 是一个容器，容纳游戏中的各个元素，如精灵，标签，节点对象。它负责着游戏的运行逻辑，以帧为单位渲染内容。在使用 Cocos2d-x 进行游戏的开发中，你可以制作任意数量的场景，并在不同场景间轻松切换。

### 创建场景

1. 创建一个类
2. 类继承节点进行重写

创建自定义的类,类名放入项目文件中的`Class`里,

新建一个头文件`xxx.h`

```cpp
#pragma once 			//预处理,让头文件不会被重复包含
#ifndef EXAMPLE_H		
#define EXAMPLE_H

#include "cocos2d.h"	//cocos2d的头文件,里面包含了多个cocos2d所需要的头文件

//创建一个自定义场景,并继承一个图层类
class Example : public cocos2d:layer{
public:
    //创建场景函数
    static cocos2d::createScene();
    //初始化
    virtual bool init() override;
     //调用宏
    CREATE_FUNC(Example);
};

#endif //EXAMPLE_H
```

### 多个场景进行切换

使用`Director`类进行场景管理

如

```cpp
auto direct=Director::getInstance();
direct->runWithScene();	//创建一个场景
```

`Director`类能做的操作

```cpp
//第一个场景启动调用该函数
void runWithScene(Scene *scene);

//切换到下一场景,并将当前场景挂在栈中
void pushScene(Scene *scene);

//回到上一次场景
void popScene(Scene *scene);

//回到根场景
void popToRootScene();

//切换场景,原来的会被释放掉
void replace(Scene *scene);
```



### 场景的生命周期

```cpp
//初始话时调用
bool init();

//进入层调用
void onEnter();

//进入层且过渡动画结束时调用
void EnterTransitionDidFinish();

//退出层时调用
void onExit();

//退出层开始过渡动画时调用
void onExitTransitionDidStart();

//被清理时调用
void cleanup();
```





## 设计思想

+ 导演
+ 场景
+ 布景
+ 角色
+ 动作
+ 节点

导演->场景->层级->精灵

## 委托类

委托类是cocos2d的入口文件里面有程序调用的生命周期

```cpp
class AppDelegate{
    void initContextAttrs();
    //启动完成后调用的函数
    bool applicationDidFinishLaunching();
    //进入后台时候调用的函数
    void applicationDidEnterBackground();
    //进入前台时候调用的函数
    void applicationWillEnterForeground();
};
```





## 导演类

```cpp
class Director{
	static Director* getInstance();
	//运行场景,场景的入口点
	void runWithScene();
	//
	void pushScene();
	
	void popScene();
	
	void pause();
	
	void resume();
};

```

使用

```cpp
//获取实例对象
auto director = Director::getInstance();
//设置glview
director->setOpenGLView(glview);
 // 显示 FPS
  director->setDisplayStats(true);
// 设置帧率
  director->setAnimationInterval(1.0 / 60);
//
director->setContentScaleFactor();
```



## GLView

```cpp
//设置分辨率
glview->setDesignResolutionSize(designResolutionSize.width, designResolutionSize.height, ResolutionPolicy::NO_BORDER);
```

## 摄像机

```
class Camera{

}
```



## 图层(layer)

颜色图层

```cpp
//颜色层
class LayerColor{
	//设置填充颜色
	static  LayerColor* layerWithColor(color3B& color);
};

//渐变色图层
class LayerGradient{
    static  LayerGradient* layerWithColor(color3B& color);
};
```



# 场景节点

场景，节点，节点文件的区别

- 场景文件不能改变大小
- 图层文件可以改变大小
- 节点文件没有大小



- 场景文件不能与场景文件嵌套
- 图层可以和节点嵌套

# 节点关系

### 场景坐标

#### 锚点

## 节点(Node)

### 引用计数

每个cocos2d对象都继承了节点类,节点类有下列方法

